/* Core theme */
:root {
	--bg: #0a0a0b;
	--bg-elev: #0f1115;
	--bg-elev-2: #13161b;
	--text: #e7e9ee;
	--muted: #9aa3af;
	--accent: #f7c87a;
	--accent-2: #ff8d4d;
	--ring: #f7c87a55;
	--error: #ff5a5f;
	--radius: 18px;
	--shadow: 0 8px 30px rgba(0,0,0,.35);
	--transition-fast: .2s ease;
	--transition-slow: 1.2s ease-in-out;
	--flicker-scale: 1;
	--flame-brightness: 1;
}

@media (prefers-reduced-motion: reduce) {
	:root {
		--flicker-scale: .2;
	}
	* { animation-duration: .001ms !important; animation-iteration-count: 1 !important; transition-duration: .01ms !important; }
}

html, body {
	height: 100%;
}

body {
	margin: 0;
	font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
	background: var(--bg);
	color: var(--text);
	line-height: 1.6;
	text-rendering: optimizeLegibility;
}

.site-header, .site-footer {
	max-width: 980px;
	margin: 0 auto;
	padding: 16px;
	display: flex;
	align-items: center;
	justify-content: space-between;
}

.brand {
	font-size: 18px;
	font-weight: 700;
	letter-spacing: .3px;
	margin: 0;
}

.controls { display: flex; gap: 12px; align-items: center; }
.control { display: flex; gap: 8px; align-items: center; }
.switch { display: inline-flex; gap: 8px; align-items: center; color: var(--muted); }
select, button, .ghost, .primary {
	background: var(--bg-elev);
	color: var(--text);
	border: 1px solid #23262e;
	border-radius: 12px;
	padding: 8px 12px;
	box-shadow: var(--shadow);
	transition: transform var(--transition-fast), background var(--transition-fast), border-color var(--transition-fast);
}
select:focus, button:focus { outline: 2px solid var(--ring); outline-offset: 2px; }
button:hover, select:hover { transform: translateY(-1px); }
button:active { transform: translateY(0); }
button.ghost { background: var(--bg-elev); color: var(--muted); }
button.primary { background: linear-gradient(180deg, #2a211a, #1b140e); border-color: #2f241a; }

.container { max-width: 980px; margin: 0 auto; padding: 12px 16px 48px; }
.hero { text-align: center; padding: 12px 0 8px; }
.tagline { font-size: 22px; font-weight: 600; margin: 8px 0 12px; color: var(--text); }
.accent { color: var(--accent); }

.ignite-btn { position: relative; font-weight: 600; padding: 12px 18px; }
.hold-ring { position: absolute; inset: -6px; border-radius: 16px; border: 2px dashed #38342c; pointer-events: none; }

.ritual { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; align-items: center; }
@media (max-width: 800px) { .ritual { grid-template-columns: 1fr; } }

.candle {
	width: 220px; height: 320px; margin: 0 auto; position: relative; display: grid; place-items: end center;
	border-radius: var(--radius);
	background: radial-gradient(120px 120px at 50% 60%, rgba(255,183,77,.05), rgba(0,0,0,0)), var(--bg-elev);
	box-shadow: inset 0 0 0 1px #23262e, var(--shadow);
}
.candle-body { position: relative; width: 80px; height: 200px; background: linear-gradient(180deg, #efe1ce, #d9c9b1); border-radius: 18px; box-shadow: inset 0 -8px 16px rgba(0,0,0,.15); display: flex; align-items: flex-end; justify-content: center; }
.wax { position: absolute; bottom: 0; width: 100%; height: 100%; background: linear-gradient(180deg, #f7f1e6, #e9dcc7); border-radius: 18px; box-shadow: inset 0 -6px 14px rgba(0,0,0,.2); transition: height var(--transition-slow); cursor: pointer; }
.flame { position: absolute; bottom: 180px; width: 26px; height: 42px; background: radial-gradient(ellipse at 50% 55%, #ffd27a 0%, #ff9b42 60%, rgba(255,155,66,0) 70%); border-radius: 50% 50% 50% 50%/60% 60% 40% 40%; filter: drop-shadow(0 0 14px rgba(255, 180, 90, calc(.8 * var(--flame-brightness)))); opacity: 0; transform-origin: 50% 90%; pointer-events: auto; }
.candle.lit .flame { opacity: 1; animation: flicker 1.2s ease-in-out infinite; }

@keyframes flicker {
	0% { transform: translateX(0) scale(calc(.98 + .04 * var(--flicker-scale))) rotate(-1deg); }
	25% { transform: translateX(-1px) scale(calc(1 + .03 * var(--flicker-scale))) rotate(1deg); }
	50% { transform: translateX(1px) scale(calc(.99 + .05 * var(--flicker-scale))) rotate(-.5deg); }
	75% { transform: translateX(-.5px) scale(calc(1 + .04 * var(--flicker-scale))) rotate(.6deg); }
	100% { transform: translateX(0) scale(calc(.98 + .04 * var(--flicker-scale))) rotate(0deg); }
}

.spark-progress { position: absolute; width: 56px; height: 56px; bottom: 170px; border-radius: 50%; box-shadow: inset 0 0 0 2px #3a342a; background: conic-gradient(var(--accent) var(--ignite-progress, 0%), transparent 0); mask: radial-gradient(circle 22px at 50% 50%, transparent 98%, #000 100%); opacity: 0; transition: opacity .2s ease; }
.candle.holding .spark-progress, .ignite-btn.holding .hold-ring { opacity: 1; }

.timer { display: grid; gap: 8px; align-content: center; justify-items: start; }
.time { font-size: 28px; font-variant-numeric: tabular-nums; letter-spacing: .5px; }
.timer-actions { display: flex; gap: 8px; }

.cards { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 12px; }
@media (max-width: 800px) { .cards { grid-template-columns: 1fr; } }
.card { background: linear-gradient(180deg, var(--bg-elev), var(--bg-elev-2)); border-radius: var(--radius); padding: 16px; box-shadow: inset 0 0 0 1px #23262e, var(--shadow); }
.card h3 { margin: 0 0 8px; font-size: 16px; color: var(--muted); }
.card p { margin: 0; font-size: 16px; }
.emoji { font-size: 20px; }

.stats { display: grid; grid-auto-flow: column; grid-auto-columns: max-content; gap: 12px; align-items: center; margin-top: 14px; }
@media (max-width: 800px) { .stats { grid-auto-flow: row; } }

.error-banner { background: #3a1114; color: #ffb4b4; border: 1px solid #5a1a1e; border-radius: 10px; padding: 10px 12px; margin-top: 10px; }

.site-footer { color: var(--muted); }

/* Modes */
body.incense { --flicker-scale: 1.6; --flame-brightness: 1.4; background: radial-gradient(600px 300px at 50% 20%, rgba(255,170,80,.04), transparent), var(--bg); }

/* Reduced motion specific flicker easing */
@media (prefers-reduced-motion: reduce) {
	.candle.lit .flame { animation: none; }
}